<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Smart‑Bin Multi‑Object Feed</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{
  --bg:#f4f7fa;--card:#fff;--txt:#222;--muted:#555;
  --brd:#e0e6ed;--shadow:0 4px 14px rgba(0,0,0,.05);
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:system-ui,sans-serif;background:var(--bg);padding:1rem}
h1{font-size:1.7rem;margin-bottom:1rem;color:var(--txt)}
#feed{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:1.2rem}
.card{background:var(--card);border:1px solid var(--brd);border-radius:12px;
      box-shadow:var(--shadow);overflow:hidden;display:flex;flex-direction:column}
.card img{width:100%;height:auto;display:block}
.card-content{padding:1rem}
pre{white-space:pre-wrap;font-size:.9rem;line-height:1.35;color:var(--muted);margin-top:.5rem}
.time{font-size:.75rem;color:var(--muted);margin-top:.75rem}
@media(prefers-color-scheme:dark){
  :root{--bg:#1e1e1e;--card:#282828;--txt:#f0f0f0;--muted:#aaa;--brd:#333;
        --shadow:0 4px 14px rgba(0,0,0,.35)}
}
</style>
</head>
<body>
<h1>Smart‑Bin Feed (Multi‑Object)</h1>
<div id="feed">Waiting for uploads…</div>

<script>
async function load(){
  const res=await fetch('/api/records');
  const data=await res.json();
  const feed=document.getElementById('feed');
  feed.innerHTML='';
  if(!data.length){feed.textContent='Waiting for uploads…';return;}
  data.forEach(r=>{
    const t=new Date(r.ts||Date.now()).toLocaleString();
    feed.insertAdjacentHTML('beforeend',`
      <div class="card">
        <img loading="lazy" src="data:image/jpeg;base64,${r.b64}">
        <div class="card-content">
          <pre>${r.report.replace(/</g,'&lt;')}</pre>
          <div class="time">${t}</div>
        </div>
      </div>`);});
}
load(); setInterval(load,5000);
</script>
</body>
</html>
