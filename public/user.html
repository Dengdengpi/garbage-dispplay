<!doctype html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1">
<title>Smartâ€‘Bin</title>
<style>
body{font-family:system-ui,sans-serif;margin:0;background:#f4f7fa;text-align:center}
button{margin:2rem auto 1rem;padding:1rem 2.2rem;font-size:1.05rem;border:0;border-radius:8px;background:#2b7cff;color:#fff;cursor:pointer}
#feed{max-width:640px;margin:auto;padding:0 1rem}
.card{background:#fff;margin:1rem 0;border-radius:10px;box-shadow:0 3px 12px rgba(0,0,0,.08)}
.card img{width:100%;display:block}
.card pre{white-space:pre-wrap;font-size:.85rem;padding:.8rem;color:#555}
small{display:block;font-size:.75rem;color:#888;padding:.5rem .8rem;border-top:1px solid #eee}
@media(prefers-color-scheme:dark){
 body{background:#1e1e1e} .card{background:#282828} pre,small{color:#bbb}
 button{background:#468bff}
}
</style>
<h2>Smartâ€‘Bin</h2>
<button id=shoot>ðŸ“¸Â Take picture</button>
<div id=feed>Loadingâ€¦</div>
<script>
const uid=localStorage.uid||crypto.randomUUID();localStorage.uid=uid;
const api="/api/records?uid="+uid;
shoot.onclick=()=>fetch("/trigger?uid="+uid).catch(alert);
async function load(){
  const r=await fetch(api); const data=await r.json();
  feed.innerHTML=''; if(!data.length){feed.textContent='No history yet.';return;}
  data.forEach(e=>{const t=new Date(e.ts).toLocaleString();
    feed.insertAdjacentHTML('beforeend',`
    <div class=card><img src="data:image/jpeg;base64,${e.b64}">
    <pre>${e.report.replace(/</g,'&lt;')}</pre><small>${t}</small></div>`);});
}
load();setInterval(load,5000);
</script>
